listeners:
  - name: http
    address: 0.0.0.0:80

  - name: pg
    socket: ./run/postgresql/.s.PGSQL.5432

handlers:
  - name: conjur
    listener: http
    match:
      - ^http\:\/\/conjur\/
    backend:
      - name: username
        value_from:
          environment: CONJUR_AUTHN_LOGIN
      - name: api_key
        value_from:
          environment: CONJUR_AUTHN_API_KEY

  - name: aws
    listener: http
    match:
      - ".*"
    backend:
      - name: access_key_id
        value_from:
          environment: AWS_ACCESS_KEY_ID
      - name: secret_access_key
        value_from:
          environment: AWS_SECRET_ACCESS_KEY

  - name: pg
    listener: pg
    backend:
      - name: address
        value_from:
          conjur: dev:variable:pg/url
      - name: username
        value_from:
          conjur: dev:variable:pg/username
      - name: password
        value_from:
          conjur: dev:variable:pg/password


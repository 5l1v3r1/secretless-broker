version: 2

services:
  mysql-tcp:
    protocol: mysql
    listenOn: tcp://0.0.0.0:13306
    credentials:
      username:
        from: conjur
        get: secretless-xa-db/mysql/username
      password:
        from: conjur
        get: secretless-xa-db/mysql/password
      host:
        from: conjur
        get: secretless-xa-db/mysql/hostname
      port:
        from: conjur
        get: secretless-xa-db/mysql/port

  mysql-sock:
    protocol: mysql
    listenOn: unix:///sock/mysql
    credentials:
      username:
        from: conjur
        get: secretless-xa-db/mysql/username
      password:
        from: conjur
        get: secretless-xa-db/mysql/password
      host:
        from: conjur
        get: secretless-xa-db/mysql/hostname
      port:
        from: conjur
        get: secretless-xa-db/mysql/port

  pg-tcp:
    protocol: pg
    listenOn: tcp://0.0.0.0:15432
    credentials:
      username:
        from: conjur
        get: secretless-xa-db/postgresql/username
      password:
        from: conjur
        get: secretless-xa-db/postgresql/password
      address:
        from: conjur
        get: secretless-xa-db/postgresql/hostname

  pg-sock:
    protocol: pg
    listenOn: unix:///sock/.s.PGSQL.5432
    credentials:
      username:
        from: conjur
        get: secretless-xa-db/postgresql/username
      password:
        from: conjur
        get: secretless-xa-db/postgresql/password
      address:
        from: conjur
        get: secretless-xa-db/postgresql/hostname
